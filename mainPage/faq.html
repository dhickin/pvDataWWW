<html>
<head>
<title>
EPICS V4 FAQ
</title>
<style>
.faq { font-weight:bold; }
.faa { font-weight:normal; margin-bottom:24px; }
</style>
</head>

<body>

<H1>EPICS V4 FAQ</H1>

<H2>Table of Contents</H2>

<ol>
<a href="#entry0"><li class="faq">What is EPICS V4?</li></a>
<a href="#entry1"><li class="faq">What is the goal of the project?</li></a>
<a href="#entry2"><li class="faq">What is the implementation language?</li></a>
<a href="#entry3"><li class="faq">What platforms are supported?</li></a>
<a href="#entry4"><li class="faq">What is the line from top to bottom for controls?</li></a>
<a href="#entry5"><li class="faq">What's going to be different from EPICS V3?</li></a>
<a href="#entry6"><li class="faq">Do I have to re-write drivers?</li></a>
<a href="#entry7"><li class="faq">What relevance does this have to controls?</li></a>
<a href="#entry8"><li class="faq">How does it work with the EPICS display tools, DM, EDM, CSS etc?</li></a>
<a href="#entry9"><li class="faq">What's the relationship of EPICS V4 to channel access?</li></a>
<a href="#entry10"><li class="faq">Can I use EPICS V4 in a mixed environment with EPICS V3?</li></a>
<a href="#entry11"><li class="faq">How does PVAS interface to an IOC?</li></a>
<a href="#entry12"><li class="faq">What's the performance?</li></a>
</ol>
<ol>
<li class="faq" id="entry0">What is EPICS V4?</li>
<div class="faa">The components of EPICS V4 are pvData, pvAccess, pvIOC and pvServices. pvData is an object model and introspection API for memory-resident structured data with a defined serialization format. pvAccess is a network protocol transporting pvData and supporting put, get, publish-subscribe, and remote procedure call. pvIOC is database of records, where a record is a pvData object plus associated processing, and records can be linked together to support data-driven processing. A pvService is any service implemented using the pvAccess protcol, typically using the RPC method.</div>
<li class="faq" id="entry1">What is the goal of the project?</li>
<div class="faa">The intention of version 4 was to create a new version of EPICS that allowed us to extend the data types on the wire and to create hierarchical records to better support devices and physics data constructs, in the distributed, robust, and high performance environment.
The usefulness of hierarchical records became less clear, as over this period, the composite records such as EVG, EVR, and BPM in version 3 were not reused. Moreover, active work was done to remove the EVG and EVR records and use the basic record types. The goal here was modified to provide better support for basic types that could have a standard set of functions applied to them.
The current scope of work is to provide an extended set of network accessible data types to better support data sources for machine control and data acquisition. This change, requires that the version 3 database is able to be served through the version 4 protocol. The version 4 protocol is then used to extend the services available to connect to relational database stores, model services, directory services, a service that aggregates version 3 data into version 4 types, and services that provide complete metadata for various forms of vector data.
As the protocol is different, existing clients must be modified to use this protocol or new clients need to be written. Within the scope of this project, we are developing Control System Studio extensions to handle these data types and to aggregate version 3 data into these data types. We are also creating a data archiver to handle these new data types.
The approach used, is to create infrastructure that can support dynamically adding new data structures to the server and to create a network protocol that can transport these data structures. To promote the development of reusable applications on the client side, a standard set of structures are being defined and supported. The architecture does not preclude create any data type you want, but it is not encouraged or supported in any of the tools being developed.</div>
<li class="faq" id="entry2">What is the implementation language?</li>
<div class="faa">Java and C++ implementations exist. pvData and pvAccess in C++ are working. pvData, pvAccess and pvIOC in Java are working. Some example pvServices have been written in Java. Work is in progress on a Python interface to the C++ libraries.</div>
<li class="faq" id="entry3">What platforms are supported?</li>
<div class="faa">For Java, any Java SE 1.5 platform. For C++, EPICS V4 uses the EPICS V3 libCom platform abstraction layer and standards-compliant C++. The C++ implementation is working on Linux, OSX, Windows and RTEMS.</div>
<li class="faq" id="entry4">What is the line from top to bottom for controls?</li>
<div class="faa">What does this mean? Is this the non-executive overview?</div>
<li class="faq" id="entry5">What's going to be different from EPICS V3?</li>
<div class="faa">EPICS V3 does not support structured data types at the record level or on the wire. There is also no method for implementing services in EPICS V3 as the put with callback in Channel Access does not return a payload. EPICS V4 does not require pre-allocated buffers for the full size of any payload so there is no longer a initialization-time limit on the maximum payload size. EPICS V4 has a single codebase for data types, client and server side networking. EPICS V3 has one client-side network library, one portable server and one server tied to the IOC.</div>
<li class="faq" id="entry6">Do I have to re-write drivers?</li>
<div class="faa">The goal is to make pvIOC C++ an asyn portDriver client so that existing asyn drivers such as areaDetector can be re-used.</div>
<li class="faq" id="entry7">What relevance does this have to controls?</li>
<div class="faa">New standardized data types such as statistical samples and unbounded variable-length arrays will replace ad-hoc workarounds necessary in the EPICS V3 environment allowing the controls engineer to focus on problems closer to the bottom line.</div>
<li class="faq" id="entry8">How does it work with the EPICS display tools, DM, EDM, CSS etc?</li>
<div class="faa">As EPICS V4 uses a new network protocol the client tools will have to be updated to use pvAccess. Work is in progress to modify CSS using the pvManager abtstraction layer (this is not specfic to EPICS V3 but a library that can talk to V3 or V4).</div>
<li class="faq" id="entry9">What's the relationship of EPICS V4 to channel access?</li>
<div class="faa">EPICS V4 has a new network protocol pvAccess that is not compatible but provides extra functionality such RPC, does not require fixed-size network buffers, and supports transferring structured types.</div>
<li class="faq" id="entry10">Can I use EPICS V4 in a mixed environment with EPICS V3?</li>
<div class="faa">So far C++ implementation of pvIOC is a regular EPICS V3 IOC that provides access to EPICS V3 records via pvAccess, so new clients can talk to old servers.</div>
<li class="faq" id="entry11">How does PVAS interface to an IOC?</li>
<div class="faa">What is PVAS??</div>
<li class="faq" id="entry12">What's the performance?</li>
<div class="faa">pvAccess network performance should be at least equivalent to Channel Access. See <a href="http://www.c-ad.bnl.gov/pac2011/proceedings/papers/mop252.pdf">Server Development for NSLS-II Physics Applications and Performance Analysis</a></div>
</ol>

</body>
</html>

